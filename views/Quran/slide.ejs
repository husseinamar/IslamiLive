<html>
    <head>
        <meta http-equiv="content-Type" content="text/html; utf-8" />
        <meta http-equiv="Pragma" content="no-cache" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <style>
            @font-face {
                font-family: 'me-quran';
                src: URL('../../public/fonts/me_quran.ttf');
            }

            html, body {
                padding: 0!important;
                margin: 0!important;
                width: 1920px!important;
                height: 1080px!important;
            }

            div.slide {
                position: relative;
                left: 0;
                top: 0;
                width: 1922px;
                height: 1080px;
                padding: 0!important;
                margin: 0!important;
                background-image: url("<%= assets.background.src %>");
                background-position: -1 1;
                background-repeat: no-repeat;
                background-size: 1924px 1086px;
                overflow: hidden;
            }

            div.slide.light {
                background-image: url("<%= assets.backgroundLight.src %>");
            }

            .ribbon {
                width: 1922px;
                height: 100px;
                background-image: url("<%= assets.ribbon.src %>");
                background-repeat: no-repeat;
                background-size: 1922px 100px;
                position: absolute;
                bottom: 25px;
            }

            .lantern {
                --width: <%= assets.lantern.width %>px;
                --height: <%= assets.lantern.height %>px;
                background-image: url("<%= assets.lantern.src %>");
                background-repeat: no-repeat;
                background-size: calc(var(--width) * 0.8) calc(var(--height) * 0.8);
                width: calc(var(--width) * 0.8);
                height: calc(var(--height) * 0.8);
                position: absolute;
            }

            .small .lantern {
                background-size: calc(var(--width) * 0.6) calc(var(--height) * 0.6);
                width: calc(var(--width) * 0.6);
                height: calc(var(--height) * 0.6);
                top: -45px;
            }

            .small .lantern.left {
                left: 45px;
            }

            .small .lantern.right {
                left: 515px;
            }

            .big .lantern.right {
                left: 600px;
                top: 0;
            }

            .image {
                --width: <%= assets.image.width %>px;
                --height: <%= assets.image.height %>px;
                background-image: url('<%= assets.image.src %>');
                background-size: calc(50px + var(--width)) calc(var(--height) * 0.9);
                background-repeat: no-repeat;
                width: calc(50px + var(--width));
                height: var(--height);
                position: absolute;
                top: 30px;
                left: 60px;
            }

            .text {
                color: #eaeaea;
            }

            div.slide.light .text {
                color: #1d1d1d;
            }

            .text .arabic {
                font-family: 'me-quran';
                text-align: center;
                width: 1100px;
                height: 500px;
                font-size: 5rem;
                line-height: 10rem;
                position: absolute;
                right: 75px;
                top: 50px;
                word-spacing: 10;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .verseNumber {
                font-family: 'me-quran';
                white-space: nowrap;
            }

            .text .german {
                font-family: 'Helvetica';
                text-align: center;
                width: 1770px;
                height: 450px;
                font-size: 4rem;
                line-height: 8rem;
                position: absolute;
                left: 75px;
                top: 550px;
                word-spacing: 5;
                font-weight: 600;
            }

            @media print {
                .slide {
                    page-break-before: always;
                }
            }
        </style>
        <script>
            String.prototype.toArabicDigits= function(){
                var id= ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
                return this.replace(/[0-9]/g, function(w){
                    return id[+w]
                });
            }
        </script>
    </head>
    <body>
    <% if( content !== undefined ) { %>
        <% content.slides.forEach((slide) => { %>
            <script>
                var slideNumber = '<%= slide.number %>'.toArabicDigits();
            </script>
            <div class="slide light">
                <div class="lanterns">
                    <div class="small">
                        <div class="lantern left"></div>
                        <div class="lantern right"></div>
                    </div>
                    <div class="big">
                        <div class="lantern right"></div>
                    </div>
                </div>
                <div class="image"></div>
                <div class="text">
                    <div class="arabic" dir="rtl">
                        <p><%= slide.arabic %> ﴿<script>document.write(slideNumber)</script>﴾</p>
                        <!-- <p><%= slide.arabic %> (<%= slide.number %>)</p> -->
                    </div>
                    <div class="german" dir="ltr">
                        <p><%= slide.german %> <span class="verseNumber">(<%= slide.number %>)</span></p>
                    </div>
                </div>
                <div class="ribbon"></div>
            </div>
        <% }); %>
    <% } %>
    <script>
        
        const setFontSize = (elem, maxSize) => {
            const stringLength = elem.innerText.length;
            console.log("String length: ", stringLength);

            const newSize = (maxSize - (stringLength / 50) * 0.25);
            elem.style.fontSize = newSize + "rem";
            elem.style.lineHeight = (newSize * 2) + "rem";
            return;
        }

        const arabicTexts = document.getElementsByClassName("arabic");
        const germanTexts = document.getElementsByClassName("german");
        for (const elem of arabicTexts) {
            setFontSize(elem, 5);
        }
        for (const elem of germanTexts) {
            setFontSize(elem, 4);
        }
        
    </script>
    </body>
</html>
